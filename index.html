<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <!-- Fontawesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    
    <title>Alec and Lana's Wedding</title>

    <style>
      body {
        color: #5a5a5a;
      }

      .divider {
        margin: 5rem 0; /* Space out the Bootstrap <hr> more */
      }

      .bg-image {
        /* The image used */
        background-image: url("static/engagement_compressed.jpg");

        /* Center and scale the image nicely */
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;

        width: 100%;
        height: 0;
        padding-top: 66.64%; /* (img-height / img-width * container-width) */
                             /* (853 / 1280 * 100) */
      }

      .img-responsive {
        display: block;
        max-width: 100%;
        height: auto;
      }
    </style>
  </head>
  <body>
    <header>
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">Alec and Lana's Wedding</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item active">
              <a class="nav-link" href="#">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#rsvp">RSVP</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#ceremony">Event</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#hotels">Where to Stay</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#other">Everything Else</a>
            </li>
          </ul>
        </div>
      </nav>
    </header>

    <main role="main">
      <div class="bg-image"></div>

      <div class="container" style="margin-top: 20px; max-width: 650px;">
        <div id="rsvp" class="row">
          <div style="width: 100%">
            <h1 class="text-center" style="width: 100%">RSVP</h1>
          </div>
          <div class="container text-center">
            <p>Let us know you're coming! Please RSVP by May 15th, 2019</p>
            <div class="container">
              <div
                class="btn btn-primary btn-md"
                role="button"
                onclick="beginRSVP();"
              >
                Click to RSVP
              </div>
            </div>
            <div id="rsvp-form" style="margin-top: 15px; display: none;">
              <div id="rsvp_entries"></div>
              <div style="width: 100%;">
                <div style="display: inline-block;" class="float-right">                
                  <button onclick="addEntry();" class="btn btn-secondary">+</button>
                  <button onclick="submitRSVP()" class="btn btn-primary">
                    <div id="submit-spinner" class="spinner-border spinner-border-sm" role="status" style="display: none;">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <span id="submit-success" style="display: none;"><i class="fas fa-check"></i></span>
                    Submit
                  </button>
                </div>
              </div>
            </div>
            <div id="rsvp-success-message" style="margin-top: 15px; display: none;">
              <div class="alert alert-success" role="alert">
                <h4 class="alert-heading">Thanks for RSVPing!</h4>
                <p>Your RSVP has been sent safe and sound. That's all we need, thanks for RSVPing!</p>
              </div>
            </div>
            <!-- <div class="container">
              <a href="mailto:wedding@rosenbaum.io?subject=Lana%20and%20Alec's%20Wedding%20RSVP&body=Hi%20Alec%20and%20Lana!%0d%0d[%20]%20I%20won't%20be%20able%20to%20attend%20:(%0d[%20]%20I%20would%20love%20to%20attend!%0d%0dAnything%20else%20we%20should%20know%20about?%20Allergies,%20etc?%0d%0d%0dBest,%0d________" rel="EMAIL" class="btn btn-primary btn-md" role="button" aria-disabled="true">Click to RSVP</a>
            </div> -->
          </div>
        </div>

        <hr class="divider">

        <div id="ceremony" class="row">
          <div style="width: 100%">
            <h1 class="text-center" style="width: 100%">Ceremony and Reception</h1>
          </div>
          <div>
            <dl class="dl-horizontal lead">
              <dt>What</dt>
              <dd>Celebrate our marriage in the lovely gardens of Howard County Conservancy</dd>
              <dt>When</dt>
              <dd>Saturday, June 22, at 6:00 pm (sharp)</dd>
              <dt>Where</dt>
              <dd>
                  <address>
                      Howard County Conservancy<br>
                      <a href="https://goo.gl/maps/fF7e2eGL8w92">
                      10520 Old Frederick Rd,
                      Woodstock,
                      MD 21163</a><br>
                      Phone: (410) 465-8877
                  </address>
              </dd>
              <dt>Attire</dt>
              <dd>Cocktail. Be warned: Although much of the reception will be indoors, the gardens and ceremony area require walking on a small gravel path. This may be tricky in heels.
              </dd>
              <dt>Parking</dt>
              <dd>Parking is available on-site at the Conservancy</dd>
            </dl>
          </div>
        </div>

        <hr class="divider">

        <div id="hotels" class="row">
          <div style="width: 100%">
            <h1 class="text-center" style="width: 100%">Where to Stay</h1>
          </div>
          <div>
            <p>
              We have a block of <strong>15</strong> rooms available at the <a href="TODO"><strong>Holiday Inn Express Columbia East</strong></a>. The block is guaranteed until <strong>May 22, 2019</strong>, but we expect rooms to go pretty quickly. Transportation to and from the conservancy will be provided for guests staying here.
            </p>
            <p>
              Unfortunately there's some sort of event going on nearby, so we couldn't get a bigger block. There's plenty of hotels nearby, though, so accommodations shouldn't be a problem if you don't mind being a little spread out. Here's where we'd recommend looking:
            </p>
            <table class="table table-striped">
              <tbody class="container">
                <tr class="row">
                  <th class="col-md-2">Turf Valley Resort</th>
                  <td class="col-md-10">
                    The <a href="https://www.turfvalley.com/stay">Turf Valley Resort</a> is conveniently located just off the highway and very close to the wedding venue.
                    It is about a 5-10 minute drive to Howard County Conservancy <a href="#TODO">(directions)</a>.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <hr class="divider">

        <div id="other" class="row">
          <div style="width: 100%">
            <h1 class="text-center" style="width: 100%">Registry</h1>
          </div>
          <div>
            <p>
              We have a registry listed online
                <a href="https://smile.amazon.com/wedding/share/rosenbaum"><strong>here!</strong></a>
            </p>
            <p>
              We'd be equally appreciative of contributions to our honeymoon fund!
            </p>
          </div>
        </div>

        <hr class="divider">

        <div id="other" class="row">
          <div style="width: 100%">
            <h1 class="text-center" style="width: 100%">Save the Dates</h1>
          </div>
          <div>
            <p>
              There are two versions of our Save the Dates! Both are displayed below :)
            </p>
            <div class="container-fluid">
            <div class="row no-gutter">
              <div class="col-lg-6">
                <img src="static/WeddingSaveTheDateV1_compressed.jpg" class="img-responsive center-block">
              </div>
              <div class="col-lg-6">
                <img src="static/WeddingSaveTheDateV2_compressed.jpg" class="img-responsive center-block">
              </div>
            </div>
        </div>
          </div>
        </div>

      </div>


      <!-- FOOTER -->
      <footer class="container">
        <p class="float-right"><a href="#">Back to top</a></p>
      </footer>
    </main>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var rsvpCount = 0;

      // happens when someone clicks "RSVP"
      const beginRSVP = () => {
        if ($('#rsvp-form').is(":hidden")) {
          // hide the success message if it's shown
          $("#rsvp-success-message").hide();

          // add the first entry
          addEntry();

          // show the form
          $('#rsvp-form').show();
        }      
      }

      // happens when an entry is added
      const addEntry = () => {
        const template = `
          <div class="input-group mb-3 rsvp-entry">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <input id="rsvp_name_${rsvpCount}" onclick="$('#not_${rsvpCount}').toggle(!this.checked)" type="checkbox" checked>
                <label for="rsvp_name_${rsvpCount}" class="form-check-label" style="margin-left: 5px;"><span id="not_${rsvpCount}" style="display: none;">Not</span> Attending</label>
              </div>
            </div>
            <input type="text" class="form-control" placeholder="name...">
          </div>
        `;
        rsvpCount += 1;

        $("#rsvp_entries").append(template);
      }

      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }

      const submitRSVP = async () => {
        $("#submit-spinner").show();
        $(".rsvp-entry").toArray().map((val) => {
          const name = $(val).find("input[type=text]").val();
          const attending = $(val).find("input[type=checkbox]").prop("checked");
          $.post('https://8h14xk9vo3.execute-api.us-east-1.amazonaws.com/prod', JSON.stringify([name, attending ? "yes" : "no"]));
        }, []); 
        await sleep(2000);
        $("#submit-spinner").hide();

        // show the success checkmark
        $("#submit-success").show();
        setTimeout(() => {$("#submit-success").fadeOut(500);}, 1000);

        // cleanup
        setTimeout(() => {
          $('#rsvp-form').hide();
          $("#rsvp_entries").empty();

          // show the success message
          $("#rsvp-success-message").show();
        }, 1500);

      }

    </script>
  </body>
</html>
